---
title: "Phylo"
author: "Heru Handika"
date: "10/15/2021"
output: html_document
---

```{r}
library(here)
library(ape)
library(harrietr)
library(tidyverse)
```



```{r}
data <- read.dna(here("data","cytb.phy"), format="interleaved")

distance <- dist.dna(data, model = "JC69", variance = FALSE, gamma = FALSE, pairwise.deletion = FALSE, base.freq = NULL, as.matrix = FALSE)

matrix <- as.matrix(distance)

melted_distance <- melt_dist(matrix, order = NULL, dist_name = "JC69")
melted_csv <- "JC69-distances-melted.csv"
write.csv(melted_distance, here("results", melted_csv))
write.csv(matrix, here("results", "JC69-distances-matrix.csv"))
``` 



```{r}
result <- read_csv(here("results", melted_csv))

split_res <- result %>% separate(iso1, c("Genus1", "Species1", "Museum_no"), sep="_") %>%
  separate(iso2, c("Genus2", "Species2", "Museum_no2"), sep="_") %>%
  unite("Species", Genus1, Species1) %>% unite("Species2", Genus2, Species2)

```

